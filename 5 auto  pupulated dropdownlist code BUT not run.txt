import React, { Component } from 'react';
import { Field, reduxForm } from 'redux-form';
import DropdownList from 'react-widgets/lib/DropdownList';
import 'react-widgets/dist/css/react-widgets.css'
import {createPost} from '../actions/index'



const Cat = [{ cat: 'Mobile', value: 'Mobile' },
{ cat: 'Laptop', value: 'Laptop' }];

const Prod = [
{ Type: 'Mobile', value: 'Iphone' },
{ Type: 'Mobile', value: '1+' },
{ Type: 'Mobile', value: 'Xiaomi' },
{ Type: 'Mobile', value: 'Intex' },
{ Type: 'Laptop', value: 'Mac' },
{ Type: 'Laptop', value: 'HP' },
{ Type: 'Laptop', value: 'Lenovo' },
{ Type: 'Laptop', value: 'Dell' }];

const renderDropdownList = ({ input, data, valueField, textField }) =>
    <DropdownList{...input}
        data={data}
        valueField={valueField}
        textField={textField}
        onChange={input.onChange} />

class Add extends Component {
    constructor(props) {
        super(props);
        this.state = { val: [], form: '' };
        this.onchange = this.onchange.bind(this);
    }
    onchange(event) {
        var arr = [];
        Prod.map(item => {
            if (item.Type == event.cat) {
                arr.push(item);
            }
        })


        this.setState({ val: arr });
    }

    sub(val) {
        this.props.createPost(val);
        this.setState({ form: val });
        console.log(this.state.form);
    }


    render() {
        const {handleSubmit} = this.props;
        return (

            <form onSubmit={handleSubmit((val) => this.sub(val))}>


                <div>
                    <label>Title:</label>
                    <div><Field name='name' className="form-control" component='input' type='text' placeholder='Enter Product Name' /></div>
                </div>

                <div>
                    <label>Category</label>
                    <Field name="cat" component={renderDropdownList} data={Cat} valueField="value" onChange={this.onchange} textField="cat" />
                </div>

                <div>
                    <label>Product</label>
                    <Field name="prod" component={renderDropdownList} data={this.state.val} valueField="value" textField="value" />
                </div>


                <div>
                    <label>Price:</label>
                    <div><Field name='price' className="form-control" component='input' type='number' placeholder='Enter Price' /></div>
                </div>

             

                <button type="submit">Submit</button>
            </form>

        );
    }
}

export default reduxForm({ form: 'forms' })(Add)